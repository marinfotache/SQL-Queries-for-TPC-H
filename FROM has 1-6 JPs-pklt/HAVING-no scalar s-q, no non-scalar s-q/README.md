
#### Parameters defininig the current scenario are:
    * FROM has 1-6 JPs
    * the join paths are joined only by the primary key of the linking tables
    * groups may appear
    * HAVING-no scalar s-q, no non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT t1.n_name AS t1__n_name<br>&emsp; ,RTRIM(t2.c_name) AS RTRIM__t2__c_name<br>&emsp; ,t1.s_nationkey AS t1__s_nationkey<br>&emsp; ,RTRIM(t2.c_mktsegment) AS RTRIM__t2__c_mktsegment<br>&emsp; ,t2.c_address AS t2__c_address<br>&emsp; ,t1.s_phone AS t1__s_phone<br>&emsp; ,COUNT(DISTINCT t2.l_partkey) AS COUNT__DISTINCT__t2__l_partkey<br>&emsp; ,COUNT(DISTINCT EXTRACT (DAY FROM t2.l_shipdate)) AS COUNT__DISTINCT__EXTRACT____DAY__FROM__t2__l_shipdate<br>&emsp; ,MAX(t2.c_acctbal) AS MAX__t2__c_acctbal<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  supplier supplier1<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN orders orders2 ON lineitem2.l_orderkey = orders2.o_orderkey<br>&emsp;INNER JOIN customer customer2 ON orders2.o_custkey = customer2.c_custkey<br>&emsp;INNER JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey ) t2 ON  t1.n_nationkey = t2.n_nationkey  <br>WHERE<br>&emsp; SQRT(t2.l_partkey)  <  42.1781934179263 <br>&emsp; OR t2.l_discount <>  0 <br>GROUP BY<br>&emsp; t1.n_name ,  RTRIM(t2.c_name) <br>&emsp; ,t1.s_nationkey ,  RTRIM(t2.c_mktsegment) <br>&emsp; ,t2.c_address <br>&emsp; ,t1.s_phone  <br>HAVING<br>&emsp;  COUNT(DISTINCT EXTRACT (DAY FROM t2.l_shipdate)) =  4   or MAX(t2.c_acctbal) >=  2945.16   or COUNT(DISTINCT t2.l_partkey) >  10  <br>FETCH NEXt 614 ROWS ONLY


<br><br>#### ... and a "lengthier" one:
<br>


 SELECT t1.r_name AS t1__r_name<br>&emsp; ,t3.n_name AS t3__n_name<br>&emsp; ,t3.n_regionkey AS t3__n_regionkey<br>&emsp; ,LOWER(t1.r_comment) AS LOWER__t1__r_comment<br>&emsp; ,LOWER(t5.n_comment) AS LOWER__t5__n_comment<br>&emsp; ,t1.r_regionkey AS t1__r_regionkey<br>&emsp; ,t5.n_regionkey AS t5__n_regionkey<br>&emsp; ,SUBSTR(t1.n_comment, 7, 57) AS SUBSTR__t1__n_comment__7__57<br>&emsp; ,t3.r_regionkey AS t3__r_regionkey<br>&emsp; ,t3.r_comment AS t3__r_comment<br>&emsp; ,t1.n_name AS t1__n_name<br>&emsp; ,MIN(ABS(t5.s_acctbal)) AS MIN__ABS__t5__s_acctbal<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier2 ON partsupp2.ps_suppkey = supplier2.s_suppkey<br>&emsp;INNER JOIN nation nation2 ON supplier2.s_nationkey = nation2.n_nationkey ) t2 ON  t1.n_nationkey = t2.n_nationkey <br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem3<br>&emsp;INNER JOIN orders orders3 ON lineitem3.l_orderkey = orders3.o_orderkey<br>&emsp;INNER JOIN customer customer3 ON orders3.o_custkey = customer3.c_custkey<br>&emsp;INNER JOIN nation nation3 ON customer3.c_nationkey = nation3.n_nationkey<br>&emsp;INNER JOIN region region3 ON nation3.n_regionkey = region3.r_regionkey ) t3 ON t1.l_orderkey = t3.l_orderkey<br>&emsp; AND t1.l_linenumber = t3.l_linenumber  FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem4<br>&emsp;RIGHT JOIN partsupp partsupp4 ON lineitem4.l_suppkey = partsupp4.ps_suppkey<br>&emsp; AND lineitem4.l_partkey = partsupp4.ps_partkey ) t4 ON t2.l_orderkey = t4.l_orderkey<br>&emsp; AND t2.l_linenumber = t4.l_linenumber <br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp5<br>&emsp;INNER JOIN supplier supplier5 ON partsupp5.ps_suppkey = supplier5.s_suppkey<br>&emsp;INNER JOIN nation nation5 ON supplier5.s_nationkey = nation5.n_nationkey ) t5 ON t2.ps_partkey = t5.ps_partkey<br>&emsp; AND t2.ps_suppkey = t5.ps_suppkey <br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem6<br>&emsp;RIGHT JOIN partsupp partsupp6 ON lineitem6.l_suppkey = partsupp6.ps_suppkey<br>&emsp; AND lineitem6.l_partkey = partsupp6.ps_partkey<br>&emsp;RIGHT JOIN part part6 ON partsupp6.ps_partkey = part6.p_partkey ) t6 ON t1.ps_partkey = t6.ps_partkey<br>&emsp; AND t1.ps_suppkey = t6.ps_suppkey  <br>WHERE<br>&emsp; t4.ps_suppkey NOT IN  ( 10, 48)  <br>&emsp; AND LOG(10<br>&emsp; ,t6.p_partkey)  >=  7.07411681619736 <br>GROUP BY<br>&emsp; t1.r_name <br>&emsp; ,t3.n_name <br>&emsp; ,t3.n_regionkey ,  LOWER(t1.r_comment) ,  LOWER(t5.n_comment) <br>&emsp; ,t1.r_regionkey <br>&emsp; ,t5.n_regionkey ,  SUBSTR(t1.n_comment, 7, 57) <br>&emsp; ,t3.r_regionkey <br>&emsp; ,t3.r_comment <br>&emsp; ,t1.n_name  <br>HAVING<br>&emsp;  MIN(ABS(t5.s_acctbal)) not in ( 290.06, 2371.51, 4170.51, 5630.62, 5755.94, 6565.11 )  or MIN(ABS(t5.s_acctbal)) <=  5302.37   or MIN(ABS(t5.s_acctbal)) in ( 632.16, 1432.69, 1887.62, 4192.4, 4515.8, 5916.91, 7014.5, 7174.74, 8080.14 ) <br>ORDER BY<br>&emsp; MIN(ABS(t5.s_acctbal)) DESC<br>&emsp; ,t3.r_comment ASC <br>FETCH NEXt 881 ROWS ONLY

