
#### Parameters defininig the current scenario are:
    * FROM has 1-6 JPs
    * the join paths are joined by any attribute(s) of the linking table
    * groups may appear
    * HAVING-max 3 scalar s-q, no non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT SUBSTR(t1.p_type, 5, 34) AS SUBSTR__t1__p_type__5__34<br>&emsp; ,t1.p_partkey AS t1__p_partkey<br>&emsp; ,t1.p_container AS t1__p_container<br>&emsp; ,SUM(LOG(10<br>&emsp; ,t2.l_quantity)) AS SUM__LOG__10__t2__l_quantity<br>&emsp; ,MIN(SUBSTR(t1.p_comment, 7, 136)) AS MIN__SUBSTR__t1__p_comment__7__136<br>&emsp; ,MIN(t1.p_size) AS MIN__t1__p_size<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1 FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.ps_availqty = t2.ps_availqty  <br>WHERE<br>&emsp; t1.p_retailprice <>  1415.51 <br>&emsp; OR t2.l_shipinstruct NOT LIKE  '% ' <br>&emsp; OR t1.p_comment >  'usly across the car' <br>GROUP BY<br>&emsp;  SUBSTR(t1.p_type, 5, 34) <br>&emsp; ,t1.p_partkey <br>&emsp; ,t1.p_container  <br>HAVING<br>&emsp;  MIN(t1.p_size) <=  <br>(SELECT  MIN(t1.p_size) AS MIN__t1__p_size <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1 FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.ps_availqty = t2.ps_availqty   <br>WHERE<br>&emsp; t1.p_retailprice <>  1415.51 <br>&emsp; OR t2.l_shipinstruct NOT LIKE  '% ' <br>&emsp; OR t1.p_comment >  'usly across the car' <br>&emsp; AND t1.p_mfgr =  'Manufacturer#3           '  )    or MIN(SUBSTR(t1.p_comment, 7, 136)) >=  <br>(SELECT  MIN(SUBSTR(t1.p_comment, 7, 136)) AS MIN__SUBSTR__t1__p_comment__7__136 <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1 FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.ps_availqty = t2.ps_availqty   <br>WHERE<br>&emsp; t1.p_retailprice <>  1415.51 <br>&emsp; OR t2.l_shipinstruct NOT LIKE  '% ' <br>&emsp; OR t1.p_comment >  'usly across the car' <br>&emsp; AND t2.l_orderkey NOT BETWEEN  1602<br>&emsp; AND 16230 <br>&emsp; AND ROUND(t2.l_extendedprice, 1)  NOT BETWEEN  24127.3<br>&emsp; AND 70316.5  )    and SUM(LOG(10<br>&emsp; ,t2.l_quantity)) not in ( 27.7258872223978, 68.0239476332432, 81.2415060330663, 87.8889830934488, 195.601150271408, 231.229740631693, 237.515159665373, 277.258872223978, 329.720548151669, 361.091791264422 ) <br>ORDER BY<br>&emsp; MIN(t1.p_size) DESC <br>FETCH NEXt 530 ROWS ONLY


<br><br>#### ... and a "lengthier" one:
<br>


 SELECT UPPER(t1.p_type) AS UPPER__t1__p_type<br>&emsp; ,LTRIM(t1.p_mfgr) AS LTRIM__t1__p_mfgr<br>&emsp; ,t1.p_partkey AS t1__p_partkey<br>&emsp; ,t1.p_container AS t1__p_container<br>&emsp; ,LOWER(t1.ps_comment) AS LOWER__t1__ps_comment<br>&emsp; ,t1.p_brand AS t1__p_brand<br>&emsp; ,MIN(t1.l_partkey) AS MIN__t1__l_partkey<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.l_commitdate = t2.l_commitdate  <br>WHERE<br>&emsp; t2.l_extendedprice BETWEEN  5700.24<br>&emsp; AND 9050 <br>&emsp; OR t1.p_retailprice <=  1517.61 <br>&emsp; OR t1.p_size <=  22 <br>&emsp; OR SQRT(t2.l_tax)  NOT IN  ( 0, 0.223606797749979, 0.264575131106459)  <br>&emsp; OR EXTRACT (MONTH FROM t1.l_commitdate)  >=  10 <br>&emsp; OR FLOOR(t2.ps_availqty)  <>  4592 <br>&emsp; OR t1.l_linestatus <>  'O' <br>GROUP BY<br>&emsp;  UPPER(t1.p_type) ,  LTRIM(t1.p_mfgr) <br>&emsp; ,t1.p_partkey <br>&emsp; ,t1.p_container ,  LOWER(t1.ps_comment) <br>&emsp; ,t1.p_brand  <br>HAVING<br>&emsp;  MIN(t1.l_partkey) <=  1590   or MIN(t1.l_partkey) >=  1893   and MIN(t1.l_partkey) <>  <br>(SELECT  MIN(t1.l_partkey) AS MIN__t1__l_partkey <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.l_commitdate = t2.l_commitdate   <br>WHERE<br>&emsp; t2.l_extendedprice BETWEEN  5700.24<br>&emsp; AND 9050 <br>&emsp; OR t1.p_retailprice <=  1517.61 <br>&emsp; OR t1.p_size <=  22 <br>&emsp; OR SQRT(t2.l_tax)  NOT IN  ( 0, 0.223606797749979, 0.264575131106459)  <br>&emsp; OR EXTRACT (MONTH FROM t1.l_commitdate)  >=  10 <br>&emsp; OR FLOOR(t2.ps_availqty)  <>  4592 <br>&emsp; OR t1.l_linestatus <>  'O' <br>&emsp; AND t2.l_shipinstruct LIKE  '%ECT COD              '  )    and MIN(t1.l_partkey) >  <br>(SELECT  MIN(t1.l_partkey) AS MIN__t1__l_partkey <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.l_commitdate = t2.l_commitdate   <br>WHERE<br>&emsp; t2.l_extendedprice BETWEEN  5700.24<br>&emsp; AND 9050 <br>&emsp; OR t1.p_retailprice <=  1517.61 <br>&emsp; OR t1.p_size <=  22 <br>&emsp; OR SQRT(t2.l_tax)  NOT IN  ( 0, 0.223606797749979, 0.264575131106459)  <br>&emsp; OR EXTRACT (MONTH FROM t1.l_commitdate)  >=  10 <br>&emsp; OR FLOOR(t2.ps_availqty)  <>  4592 <br>&emsp; OR t1.l_linestatus <>  'O' <br>&emsp; AND t2.ps_supplycost >=  704.76  )    or MIN(t1.l_partkey) <=  <br>(SELECT  MIN(t1.l_partkey) AS MIN__t1__l_partkey <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON  t1.l_commitdate = t2.l_commitdate   <br>WHERE<br>&emsp; t2.l_extendedprice BETWEEN  5700.24<br>&emsp; AND 9050 <br>&emsp; OR t1.p_retailprice <=  1517.61 <br>&emsp; OR t1.p_size <=  22 <br>&emsp; OR SQRT(t2.l_tax)  NOT IN  ( 0, 0.223606797749979, 0.264575131106459)  <br>&emsp; OR EXTRACT (MONTH FROM t1.l_commitdate)  >=  10 <br>&emsp; OR FLOOR(t2.ps_availqty)  <>  4592 <br>&emsp; OR t1.l_linestatus <>  'O' <br>&emsp; AND t2.l_comment <  'ly pending req' <br>&emsp; AND TO_CHAR(t1.l_shipdate, 'D')  BETWEEN  1<br>&emsp; AND 2 <br>&emsp; AND t1.l_returnflag =  'R'  )   <br>ORDER BY<br>&emsp; UPPER(t1.p_type) DESC<br>&emsp; ,t1.p_partkey DESC <br>OFFSET 32 ROWS <br>FETCH NEXt 296 ROWS ONLY

