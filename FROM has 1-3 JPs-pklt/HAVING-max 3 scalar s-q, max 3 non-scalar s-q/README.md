
#### Parameters defininig the current scenario are:
    * FROM has 1-3 JPs
    * the join paths are joined only by the primary key of the linking tables
    * groups may appear
    * HAVING-max 3 scalar s-q, max 3 non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT ROUND(t1.l_quantity, 0) AS ROUND__t1__l_quantity__0<br>&emsp; ,EXTRACT (YEAR FROM t3.l_receiptdate) AS EXTRACT____YEAR__FROM__t3__l_receiptdate<br>&emsp; ,EXTRACT (MONTH FROM t3.l_receiptdate) AS EXTRACT____MONTH__FROM__t3__l_receiptdate<br>&emsp; ,t3.l_shipmode AS t3__l_shipmode<br>&emsp; ,t3.ps_partkey AS t3__ps_partkey<br>&emsp; ,t3.l_shipinstruct AS t3__l_shipinstruct<br>&emsp; ,t3.l_extendedprice AS t3__l_extendedprice<br>&emsp; ,LOG(2<br>&emsp; ,t1.l_linenumber) AS LOG__2__t1__l_linenumber<br>&emsp; ,SQRT(t3.s_suppkey) AS SQRT__t3__s_suppkey<br>&emsp; ,t1.p_brand AS t1__p_brand<br>&emsp; ,t3.ps_suppkey AS t3__ps_suppkey<br>&emsp; ,t3.n_regionkey AS t3__n_regionkey<br>&emsp; ,t2.ps_comment AS t2__ps_comment<br>&emsp; ,LTRIM(t1.p_comment) AS LTRIM__t1__p_comment<br>&emsp; ,EXTRACT (MONTH FROM t1.l_receiptdate) AS EXTRACT____MONTH__FROM__t1__l_receiptdate<br>&emsp; ,UPPER(t3.ps_comment) AS UPPER__t3__ps_comment<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1 FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp2<br>&emsp;RIGHT JOIN supplier supplier2 ON partsupp2.ps_suppkey = supplier2.s_suppkey ) t2 ON t1.ps_partkey = t2.ps_partkey<br>&emsp; AND t1.ps_suppkey = t2.ps_suppkey <br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem3<br>&emsp;RIGHT JOIN partsupp partsupp3 ON lineitem3.l_suppkey = partsupp3.ps_suppkey<br>&emsp; AND lineitem3.l_partkey = partsupp3.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier3 ON partsupp3.ps_suppkey = supplier3.s_suppkey<br>&emsp;INNER JOIN nation nation3 ON supplier3.s_nationkey = nation3.n_nationkey ) t3 ON t1.ps_partkey = t3.ps_partkey<br>&emsp; AND t1.ps_suppkey = t3.ps_suppkey  <br>WHERE<br>&emsp; t2.s_comment IN  ( 'eposits. slyly final deposits toward the slyly regular dependencies sleep among the excu')  <br>&emsp; AND t2.s_address NOT BETWEEN  'n48Wy4QI3lml8T217rk'<br>&emsp; AND 'SLlacbhgpKmVa,gF3saYv12e0' <br>&emsp; OR t3.l_returnflag NOT IN  ( 'A', 'A', 'N', 'N', 'N', 'N', 'R', 'R', 'R', 'R')  <br>&emsp; OR t1.ps_comment <=  'o beans boost carefully fluffily ironic accounts. express courts eat furiously. accounts boost carefull' <br>&emsp; OR EXTRACT (DAY FROM t3.l_receiptdate)  <=  17 <br>OFFSET 553 ROWS <br>FETCH NEXt 845 ROWS ONLY


<br><br>#### ... and a "lengthier" one:
<br>


 SELECT SUBSTR(orders.o_orderstatus, 1, 1) AS SUBSTR__orders__o_orderstatus__1__1<br>&emsp; ,orders.o_orderpriority AS orders__o_orderpriority<br>&emsp; ,COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority<br>&emsp; ,COUNT(DISTINCT SUBSTR(orders.o_clerk, 8, 35)) AS COUNT__DISTINCT__SUBSTR__orders__o_clerk__8__35<br>FROM<br>&emsp; orders <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>GROUP BY<br>&emsp;  SUBSTR(orders.o_orderstatus, 1, 1) <br>&emsp; ,orders.o_orderpriority  <br>HAVING<br>&emsp;  COUNT(DISTINCT orders.o_shippriority) not in ( <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND EXTRACT (MONTH FROM orders.o_orderdate)  >  5 <br>&emsp; AND orders.o_orderstatus NOT BETWEEN  'F'<br>&emsp; AND 'P' <br>&emsp; AND orders.o_custkey >  1345  ) ,  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_orderstatus <=  'O' <br>&emsp; AND orders.o_clerk <  'Clerk#000000717' <br>&emsp; AND orders.o_orderkey <=  14048  ) ,  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_orderpriority >=  '1-URGENT       '  ) ,  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_custkey <  1387 <br>&emsp; AND orders.o_totalprice IN  ( 9777.25, 23078.95, 161689.12)   ) ,  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND EXTRACT (MONTH FROM orders.o_orderdate)  NOT IN  ( 1, 3, 4, 5, 7, 10, 12)  <br>&emsp; AND orders.o_custkey <>  187  ) ,  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_clerk BETWEEN  'Clerk#000000029'<br>&emsp; AND 'Clerk#000000229' <br>&emsp; AND orders.o_orderstatus BETWEEN  'F'<br>&emsp; AND 'P'  ) ,  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_orderstatus IN  ( 'O', 'O', 'P', 'P')  <br>&emsp; AND orders.o_orderdate NOT IN  ( DATE'1993-11-25'<br>&emsp; ,DATE'1994-09-01'<br>&emsp; ,DATE'1995-08-27'<br>&emsp; ,DATE'1995-10-02'<br>&emsp; ,DATE'1995-11-17'<br>&emsp; ,DATE'1997-09-09'<br>&emsp; ,DATE'1997-11-28')  <br>&emsp; AND orders.o_orderkey <=  55904  )  )  or COUNT(DISTINCT SUBSTR(orders.o_clerk, 8, 35)) >  1   or COUNT(DISTINCT SUBSTR(orders.o_clerk, 8, 35)) >= ALL  <br>(SELECT  COUNT(DISTINCT SUBSTR(orders.o_clerk, 8, 35)) AS COUNT__DISTINCT__SUBSTR__orders__o_clerk__8__35 <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_orderstatus <>  'P' <br>&emsp; AND orders.o_totalprice <>  139586.17  <br>GROUP BY<br>&emsp;  SUBSTR(orders.o_orderstatus, 1, 1) <br>&emsp; ,orders.o_orderpriority  )    or COUNT(DISTINCT SUBSTR(orders.o_clerk, 8, 35)) >  <br>(SELECT  COUNT(DISTINCT SUBSTR(orders.o_clerk, 8, 35)) AS COUNT__DISTINCT__SUBSTR__orders__o_clerk__8__35 <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_orderpriority NOT IN  ( '1-URGENT       ', '2-HIGH         ', '2-HIGH         ', '2-HIGH         ', '3-MEDIUM       ', '3-MEDIUM       ', '3-MEDIUM       ', '4-NOT SPECIFIED')  <br>&emsp; AND orders.o_orderkey BETWEEN  31015<br>&emsp; AND 55969  )    and COUNT(DISTINCT orders.o_shippriority) >  1   or COUNT(DISTINCT orders.o_shippriority) >  1   or COUNT(DISTINCT orders.o_shippriority) <  <br>(SELECT  COUNT(DISTINCT orders.o_shippriority) AS COUNT__DISTINCT__orders__o_shippriority <br>FROM<br>&emsp;  orders  <br>WHERE<br>&emsp; orders.o_comment LIKE  '%c excuses haggle ruthlessly about' <br>&emsp; AND orders.o_shippriority NOT IN  ( 0, 0, 0, 0)  <br>&emsp; AND orders.o_orderstatus NOT IN  ( 'F')   )   <br>ORDER BY<br>&emsp; orders.o_orderpriority ASC <br>OFFSET 585 ROWS <br>FETCH NEXt 544 ROWS ONLY

