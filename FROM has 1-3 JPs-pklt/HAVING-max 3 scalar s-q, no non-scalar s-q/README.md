
#### Parameters defininig the current scenario are:
    * FROM has 1-3 JPs
    * the join paths are joined only by the primary key of the linking tables
    * groups may appear
    * HAVING-max 3 scalar s-q, no non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT COUNT(DISTINCT customer.c_nationkey) AS COUNT__DISTINCT__customer__c_nationkey<br>FROM<br>&emsp; lineitem<br>&emsp;INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey<br>&emsp;INNER JOIN customer ON orders.o_custkey = customer.c_custkey <br>WHERE<br>&emsp; customer.c_custkey NOT BETWEEN  1011<br>&emsp; AND 1451 <br>OFFSET 831 ROWS <br>FETCH NEXt 887 ROWS ONLY


<br>#### ... and a "lenghtier" one:
<br>


 SELECT t1.ps_comment AS t1__ps_comment<br>&emsp; ,MIN(ROUND(t2.ps_availqty, 1)) AS MIN__ROUND__t2__ps_availqty__1<br>&emsp; ,MIN(ABS(t2.l_extendedprice)) AS MIN__ABS__t2__l_extendedprice<br>&emsp; ,MAX(t2.ps_partkey) AS MAX__t2__ps_partkey<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  partsupp ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON t1.ps_partkey = t2.ps_partkey<br>&emsp; AND t1.ps_suppkey = t2.ps_suppkey  <br>WHERE<br>&emsp; EXTRACT (DAY FROM t2.l_shipdate)  IN  ( 1, 7, 9, 10, 16, 18, 23, 27, 31)  <br>&emsp; OR t1.ps_suppkey =  32 <br>&emsp; AND FLOOR(t2.l_quantity)  <>  46 <br>&emsp; OR t2.l_orderkey =  17828 <br>&emsp; OR t2.ps_partkey <  1689 <br>GROUP BY<br>&emsp; t1.ps_comment  <br>HAVING<br>&emsp;  MIN(ROUND(t2.ps_availqty, 1)) =  <br>(SELECT  MIN(ROUND(t2.ps_availqty, 1)) AS MIN__ROUND__t2__ps_availqty__1 <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON t1.ps_partkey = t2.ps_partkey<br>&emsp; AND t1.ps_suppkey = t2.ps_suppkey   <br>WHERE<br>&emsp; EXTRACT (DAY FROM t2.l_shipdate)  IN  ( 1, 7, 9, 10, 16, 18, 23, 27, 31)  <br>&emsp; OR t1.ps_suppkey =  32 <br>&emsp; AND FLOOR(t2.l_quantity)  <>  46 <br>&emsp; OR t2.l_orderkey =  17828 <br>&emsp; OR t2.ps_partkey <  1689 <br>&emsp; AND t1.ps_availqty <  7339 <br>&emsp; AND t2.l_linestatus NOT IN  ( 'O')  <br>&emsp; AND t2.l_tax =  0.06  )    and MIN(ROUND(t2.ps_availqty, 1)) <=  1939   and MIN(ROUND(t2.ps_availqty, 1)) =  <br>(SELECT  MIN(ROUND(t2.ps_availqty, 1)) AS MIN__ROUND__t2__ps_availqty__1 <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON t1.ps_partkey = t2.ps_partkey<br>&emsp; AND t1.ps_suppkey = t2.ps_suppkey   <br>WHERE<br>&emsp; EXTRACT (DAY FROM t2.l_shipdate)  IN  ( 1, 7, 9, 10, 16, 18, 23, 27, 31)  <br>&emsp; OR t1.ps_suppkey =  32 <br>&emsp; AND FLOOR(t2.l_quantity)  <>  46 <br>&emsp; OR t2.l_orderkey =  17828 <br>&emsp; OR t2.ps_partkey <  1689 <br>&emsp; AND t2.l_linestatus NOT IN  ( 'F', 'F', 'F', 'F', 'O')  <br>&emsp; AND t2.l_discount IN  ( 0.08)  <br>&emsp; AND t2.l_returnflag NOT IN  ( 'A', 'A', 'A', 'A', 'N', 'N', 'N', 'R', 'R', 'R')   )    or MAX(t2.ps_partkey) <>  740   or MIN(ROUND(t2.ps_availqty, 1)) <  <br>(SELECT  MIN(ROUND(t2.ps_availqty, 1)) AS MIN__ROUND__t2__ps_availqty__1 <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey ) t2 ON t1.ps_partkey = t2.ps_partkey<br>&emsp; AND t1.ps_suppkey = t2.ps_suppkey   <br>WHERE<br>&emsp; EXTRACT (DAY FROM t2.l_shipdate)  IN  ( 1, 7, 9, 10, 16, 18, 23, 27, 31)  <br>&emsp; OR t1.ps_suppkey =  32 <br>&emsp; AND FLOOR(t2.l_quantity)  <>  46 <br>&emsp; OR t2.l_orderkey =  17828 <br>&emsp; OR t2.ps_partkey <  1689 <br>&emsp; AND t2.l_commitdate >=  DATE'1994-03-11' <br>&emsp; AND EXTRACT (MONTH FROM t2.l_receiptdate)  >  3  )   <br>ORDER BY<br>&emsp; t1.ps_comment ASC<br>&emsp; ,MIN(ROUND(t2.ps_availqty, 1)) DESC <br>FETCH NEXt 502 ROWS ONLY

