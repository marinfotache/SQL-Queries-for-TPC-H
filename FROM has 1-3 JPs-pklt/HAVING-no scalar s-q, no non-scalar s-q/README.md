
### Parameters defining the current scenario are:
    * FROM has 1-3 JPs-pklt
    * the join paths are joined only by the primary key of the linking tables
    * groups may appear
    * HAVING-no scalar subqueries, no non-scalar subqueries

### Here is a typical query of this scenario:<br>



 SELECT t1.r_name AS t1__r_name<br>&emsp; ,t1.r_comment AS t1__r_comment<br>&emsp; ,COUNT(DISTINCT RTRIM(t1.c_name)) AS COUNT__DISTINCT__RTRIM__t1__c_name<br>&emsp; ,COUNT(DISTINCT SUBSTR(t2.l_returnflag, 1, 1)) AS COUNT__DISTINCT__SUBSTR__t2__l_returnflag__1__1<br>&emsp; ,COUNT(DISTINCT t2.l_linestatus) AS COUNT__DISTINCT__t2__l_linestatus<br>&emsp; ,MAX(t2.l_extendedprice) AS MAX__t2__l_extendedprice<br>&emsp; ,COUNT(DISTINCT t1.n_comment) AS COUNT__DISTINCT__t1__n_comment<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  customer customer1<br>&emsp;RIGHT JOIN nation nation1 ON customer1.c_nationkey = nation1.n_nationkey<br>&emsp;RIGHT JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;RIGHT JOIN orders orders2 ON lineitem2.l_orderkey = orders2.o_orderkey<br>&emsp;INNER JOIN customer customer2 ON orders2.o_custkey = customer2.c_custkey ) t2 ON  t1.c_custkey = t2.c_custkey  <br>WHERE<br>&emsp; t2.o_shippriority <>  0 <br>&emsp; AND t1.c_name <>  'Customer#000000060' <br>&emsp; AND t2.l_tax <>  0.08 <br>GROUP BY<br>&emsp; t1.r_name <br>&emsp; ,t1.r_comment  <br>HAVING<br>&emsp;  COUNT(DISTINCT SUBSTR(t2.l_returnflag, 1, 1)) not between  1<br>&emsp; AND 2  <br>ORDER BY<br>&emsp; MAX(t2.l_extendedprice) DESC<br>&emsp; ,t1.r_comment ASC <br>FETCH NEXt 695 ROWS ONLY


<br><br>

### ... and a "lengthier" one:
<br>


 SELECT distinct LTRIM(t3.o_comment) AS LTRIM__t3__o_comment<br>&emsp; ,t2.n_nationkey AS t2__n_nationkey<br>&emsp; ,t1.c_acctbal AS t1__c_acctbal<br>&emsp; ,EXTRACT (YEAR FROM t3.o_orderdate) AS EXTRACT____YEAR__FROM__t3__o_orderdate<br>&emsp; ,EXTRACT (DOW<br>FROM<br>&emsp; t3.o_orderdate) AS EXTRACT____DOW__FROM__t3__o_orderdate<br>&emsp; ,LTRIM(t3.o_orderstatus) AS LTRIM__t3__o_orderstatus<br>&emsp; ,LTRIM(t2.c_mktsegment) AS LTRIM__t2__c_mktsegment<br>&emsp; ,t2.l_tax AS t2__l_tax<br>&emsp; ,t3.c_acctbal AS t3__c_acctbal<br>&emsp; ,FLOOR(t2.l_discount) AS FLOOR__t2__l_discount<br>&emsp; ,t1.o_clerk AS t1__o_clerk<br>&emsp; ,LOWER(t3.o_orderpriority) AS LOWER__t3__o_orderpriority<br>&emsp; ,t1.l_tax AS t1__l_tax<br>&emsp; ,FLOOR(t2.o_totalprice) AS FLOOR__t2__o_totalprice<br>&emsp; ,t3.c_name AS t3__c_name<br>&emsp; ,SUBSTR(t2.l_returnflag, 1, 1) AS SUBSTR__t2__l_returnflag__1__1<br>&emsp; ,LTRIM(t1.c_address) AS LTRIM__t1__c_address<br>&emsp; ,t2.r_regionkey AS t2__r_regionkey<br>&emsp; ,EXTRACT (YEAR FROM t1.l_receiptdate) AS EXTRACT____YEAR__FROM__t1__l_receiptdate<br>&emsp; ,EXTRACT (MONTH FROM t1.l_receiptdate) AS EXTRACT____MONTH__FROM__t1__l_receiptdate<br>&emsp; ,EXTRACT (DAY FROM t1.l_receiptdate) AS EXTRACT____DAY__FROM__t1__l_receiptdate<br>&emsp; ,LOWER(t3.l_shipmode) AS LOWER__t3__l_shipmode<br>&emsp; ,EXTRACT (DAY FROM t2.o_orderdate) AS EXTRACT____DAY__FROM__t2__o_orderdate<br>&emsp; ,t3.l_linenumber AS t3__l_linenumber<br>&emsp; ,t2.c_acctbal AS t2__c_acctbal<br>&emsp; ,EXTRACT (DAY FROM t2.l_shipdate) AS EXTRACT____DAY__FROM__t2__l_shipdate<br>&emsp; ,t3.c_phone AS t3__c_phone<br>&emsp; ,t1.l_comment AS t1__l_comment<br>&emsp; ,t2.l_shipmode AS t2__l_shipmode<br>&emsp; ,LOWER(t3.c_mktsegment) AS LOWER__t3__c_mktsegment<br>&emsp; ,t2.o_comment AS t2__o_comment<br>&emsp; ,t2.l_receiptdate AS t2__l_receiptdate<br>&emsp; ,t2.c_phone AS t2__c_phone<br>&emsp; ,LTRIM(t1.c_name) AS LTRIM__t1__c_name<br>&emsp; ,t1.o_orderkey AS t1__o_orderkey<br>&emsp; ,t2.c_nationkey AS t2__c_nationkey<br>&emsp; ,t3.c_nationkey AS t3__c_nationkey<br>&emsp; ,t2.o_shippriority AS t2__o_shippriority<br>&emsp; ,SUBSTR(t3.o_clerk, 6, 25) AS SUBSTR__t3__o_clerk__6__25<br>&emsp; ,t1.o_totalprice AS t1__o_totalprice<br>&emsp; ,SQRT(t3.l_discount) AS SQRT__t3__l_discount<br>&emsp; ,EXTRACT (MONTH FROM t1.l_shipdate) AS EXTRACT____MONTH__FROM__t1__l_shipdate<br>&emsp; ,EXTRACT (DOW<br>FROM<br>&emsp; t1.l_shipdate) AS EXTRACT____DOW__FROM__t1__l_shipdate<br>&emsp; ,t1.c_custkey AS t1__c_custkey<br>&emsp; ,t2.l_suppkey AS t2__l_suppkey<br>&emsp; ,SQRT(t3.l_orderkey) AS SQRT__t3__l_orderkey<br>&emsp; ,t3.o_shippriority AS t3__o_shippriority<br>&emsp; ,t3.l_suppkey AS t3__l_suppkey<br>&emsp; ,t2.l_partkey AS t2__l_partkey<br>&emsp; ,LTRIM(t2.r_name) AS LTRIM__t2__r_name<br>&emsp; ,t2.l_linenumber AS t2__l_linenumber<br>&emsp; ,SUBSTR(t2.o_clerk, 9, 63) AS SUBSTR__t2__o_clerk__9__63<br>&emsp; ,t1.l_shipinstruct AS t1__l_shipinstruct<br>&emsp; ,t1.l_extendedprice AS t1__l_extendedprice<br>&emsp; ,SQRT(t3.l_partkey) AS SQRT__t3__l_partkey<br>&emsp; ,SUBSTR(t1.l_returnflag, 1, 1) AS SUBSTR__t1__l_returnflag__1__1<br>&emsp; ,LOG(10<br>&emsp; ,t1.l_suppkey) AS LOG__10__t1__l_suppkey<br>&emsp; ,UPPER(t1.c_mktsegment) AS UPPER__t1__c_mktsegment<br>&emsp; ,t1.l_linestatus AS t1__l_linestatus<br>&emsp; ,RTRIM(t2.c_name) AS RTRIM__t2__c_name<br>&emsp; ,t1.l_linenumber AS t1__l_linenumber<br>&emsp; ,t3.l_tax AS t3__l_tax<br>&emsp; ,t1.c_phone AS t1__c_phone<br>&emsp; ,SUBSTR(t3.l_returnflag, 1, 0) AS SUBSTR__t3__l_returnflag__1__0<br>&emsp; ,t3.o_custkey AS t3__o_custkey<br>&emsp; ,t1.l_partkey AS t1__l_partkey<br>&emsp; ,t1.o_orderpriority AS t1__o_orderpriority<br>&emsp; ,t2.l_extendedprice AS t2__l_extendedprice<br>&emsp; ,RTRIM(t2.c_comment) AS RTRIM__t2__c_comment<br>&emsp; ,t2.n_name AS t2__n_name<br>&emsp; ,LTRIM(t2.c_address) AS LTRIM__t2__c_address<br>&emsp; ,EXTRACT (MONTH FROM t3.l_receiptdate) AS EXTRACT____MONTH__FROM__t3__l_receiptdate<br>&emsp; ,EXTRACT (DAY FROM t3.l_receiptdate) AS EXTRACT____DAY__FROM__t3__l_receiptdate<br>&emsp; ,UPPER(t3.l_shipinstruct) AS UPPER__t3__l_shipinstruct<br>&emsp; ,t2.l_linestatus AS t2__l_linestatus<br>&emsp; ,EXTRACT (DOW<br>FROM<br>&emsp; t2.l_commitdate) AS EXTRACT____DOW__FROM__t2__l_commitdate<br>&emsp; ,t3.c_custkey AS t3__c_custkey<br>&emsp; ,LOWER(t2.l_comment) AS LOWER__t2__l_comment<br>&emsp; ,t1.l_commitdate AS t1__l_commitdate<br>&emsp; ,EXTRACT (YEAR FROM t3.l_commitdate) AS EXTRACT____YEAR__FROM__t3__l_commitdate<br>&emsp; ,EXTRACT (MONTH FROM t3.l_commitdate) AS EXTRACT____MONTH__FROM__t3__l_commitdate<br>&emsp; ,EXTRACT (DAY FROM t3.l_commitdate) AS EXTRACT____DAY__FROM__t3__l_commitdate<br>&emsp; ,t2.o_orderkey AS t2__o_orderkey<br>&emsp; ,t1.c_nationkey AS t1__c_nationkey<br>&emsp; ,ROUND(t3.o_totalprice, 2) AS ROUND__t3__o_totalprice__2<br>&emsp; ,t1.o_custkey AS t1__o_custkey<br>&emsp; ,RTRIM(t3.c_address) AS RTRIM__t3__c_address<br>&emsp; ,t1.o_shippriority AS t1__o_shippriority<br>&emsp; ,t1.o_orderstatus AS t1__o_orderstatus<br>&emsp; ,SUBSTR(t2.l_shipinstruct, 3, 21) AS SUBSTR__t2__l_shipinstruct__3__21<br>&emsp; ,t3.l_extendedprice AS t3__l_extendedprice<br>&emsp; ,t3.l_quantity AS t3__l_quantity<br>&emsp; ,EXTRACT (YEAR FROM t3.l_shipdate) AS EXTRACT____YEAR__FROM__t3__l_shipdate<br>&emsp; ,EXTRACT (MONTH FROM t3.l_shipdate) AS EXTRACT____MONTH__FROM__t3__l_shipdate<br>&emsp; ,FLOOR(t1.l_quantity) AS FLOOR__t1__l_quantity<br>&emsp; ,t2.l_quantity AS t2__l_quantity<br>&emsp; ,t2.c_custkey AS t2__c_custkey<br>&emsp; ,t1.l_orderkey AS t1__l_orderkey<br>&emsp; ,ABS(t1.l_discount) AS ABS__t1__l_discount<br>&emsp; ,t3.l_linestatus AS t3__l_linestatus<br>&emsp; ,t2.r_comment AS t2__r_comment<br>&emsp; ,SQRT(t2.n_regionkey) AS SQRT__t2__n_regionkey<br>&emsp; ,t1.o_orderdate AS t1__o_orderdate<br>&emsp; ,RTRIM(t2.n_comment) AS RTRIM__t2__n_comment<br>&emsp; ,t1.c_comment AS t1__c_comment<br>&emsp; ,LTRIM(t3.c_comment) AS LTRIM__t3__c_comment<br>&emsp; ,SUBSTR(t1.o_comment, 13, 148) AS SUBSTR__t1__o_comment__13__148<br>&emsp; ,t2.l_orderkey AS t2__l_orderkey<br>&emsp; ,RTRIM(t1.l_shipmode) AS RTRIM__t1__l_shipmode<br>&emsp; ,t2.o_orderstatus AS t2__o_orderstatus<br>&emsp; ,RTRIM(t2.o_orderpriority) AS RTRIM__t2__o_orderpriority<br>&emsp; ,t2.o_custkey AS t2__o_custkey<br>&emsp; ,t3.l_comment AS t3__l_comment<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;RIGHT JOIN orders orders1 ON lineitem1.l_orderkey = orders1.o_orderkey<br>&emsp;INNER JOIN customer customer1 ON orders1.o_custkey = customer1.c_custkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN orders orders2 ON lineitem2.l_orderkey = orders2.o_orderkey<br>&emsp;RIGHT JOIN customer customer2 ON orders2.o_custkey = customer2.c_custkey<br>&emsp;RIGHT JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey<br>&emsp;RIGHT JOIN region region2 ON nation2.n_regionkey = region2.r_regionkey ) t2 ON  t1.o_orderkey = t2.o_orderkey  FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem3<br>&emsp;INNER JOIN orders orders3 ON lineitem3.l_orderkey = orders3.o_orderkey<br>&emsp;RIGHT JOIN customer customer3 ON orders3.o_custkey = customer3.c_custkey ) t3 ON  t1.o_orderkey = t3.o_orderkey  <br>WHERE<br>&emsp; EXTRACT (DOW<br>FROM<br>&emsp; t2.l_commitdate)  <>  3 <br>&emsp; OR t3.l_linenumber <  3 <br>&emsp; OR t1.l_returnflag <  'R' <br>&emsp; OR t2.c_name IN  ( 'Customer#075723102', 'Customer#075723479', 'Customer#075724548', 'Customer#075725635', 'Customer#075726413', 'Customer#075726656', 'Customer#075727372', 'Customer#075727542')  <br>&emsp; AND t3.l_shipinstruct IN  ( 'COLLECT COD', 'DELIVER IN PERSON', 'NONE', 'TAKE BACK RETURN')  <br>ORDER BY<br>&emsp; t2.l_orderkey DESC<br>&emsp; ,LOWER(t3.c_mktsegment) ASC<br>&emsp; ,t3.c_acctbal DESC  <br>LIMIT 644

