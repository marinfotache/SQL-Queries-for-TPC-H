
#### Parameters defininig the current scenario are:
    * FROM has 1-3 JPs
    * the join paths are joined only by the primary key of the linking tables
    * groups may appear
    * HAVING-no scalar s-q, no non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT t2.n_regionkey AS t2__n_regionkey<br>&emsp; ,RTRIM(t2.n_name) AS RTRIM__t2__n_name<br>&emsp; ,t2.c_nationkey AS t2__c_nationkey<br>&emsp; ,t1.s_name AS t1__s_name<br>&emsp; ,AVG(t1.l_tax) AS AVG__t1__l_tax<br>&emsp; ,COUNT(SQRT(t2.c_custkey)) AS COUNT__SQRT__t2__c_custkey<br>&emsp; ,COUNT(t2.c_comment) AS COUNT__t2__c_comment<br>&emsp; ,COUNT(RTRIM(t2.o_orderstatus)) AS COUNT__RTRIM__t2__o_orderstatus<br>&emsp; ,COUNT(EXTRACT (YEAR FROM t2.o_orderdate)) AS COUNT__EXTRACT____YEAR__FROM__t2__o_orderdate<br>&emsp; ,COUNT(TO_CHAR(t2.o_orderdate, 'D')) AS COUNT__TO_CHAR__t2__o_orderdate____D__<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;INNER JOIN partsupp partsupp1 ON lineitem1.l_suppkey = partsupp1.ps_suppkey<br>&emsp; AND lineitem1.l_partkey = partsupp1.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN orders orders2 ON lineitem2.l_orderkey = orders2.o_orderkey<br>&emsp;INNER JOIN customer customer2 ON orders2.o_custkey = customer2.c_custkey<br>&emsp;RIGHT JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey ) t2 ON t1.l_orderkey = t2.l_orderkey<br>&emsp; AND t1.l_linenumber = t2.l_linenumber  <br>WHERE<br>&emsp; t2.l_linenumber <=  4 <br>&emsp; AND t1.l_linestatus <>  'O' <br>&emsp; OR t2.l_shipinstruct NOT LIKE  '%BACK RETURN    %' <br>GROUP BY<br>&emsp; t2.n_regionkey ,  RTRIM(t2.n_name) <br>&emsp; ,t2.c_nationkey <br>&emsp; ,t1.s_name  <br>HAVING<br>&emsp;  AVG(t1.l_tax) not between  0.01<br>&emsp; AND 0.03  <br>ORDER BY<br>&emsp; RTRIM(t2.n_name) ASC<br>&emsp; ,t1.s_name DESC <br>OFFSET 285 ROWS <br>FETCH NEXt 644 ROWS ONLY


<br><br>#### ... and a "lengthier" one:
<br>


 SELECT t2.n_comment AS t2__n_comment<br>&emsp; ,t2.n_nationkey AS t2__n_nationkey<br>&emsp; ,t2.s_nationkey AS t2__s_nationkey<br>&emsp; ,t2.n_regionkey AS t2__n_regionkey<br>&emsp; ,t3.n_name AS t3__n_name<br>&emsp; ,COUNT(t3.n_comment) AS COUNT__t3__n_comment<br>&emsp; ,COUNT(t3.l_orderkey) AS COUNT__t3__l_orderkey<br>&emsp; ,MIN(ROUND(t3.l_quantity, 0)) AS MIN__ROUND__t3__l_quantity__0<br>&emsp; ,MIN(t3.ps_availqty) AS MIN__t3__ps_availqty<br>&emsp; ,COUNT(t2.ps_comment) AS COUNT__t2__ps_comment<br>&emsp; ,COUNT(t2.l_orderkey) AS COUNT__t2__l_orderkey<br>&emsp; ,MIN(t2.l_quantity) AS MIN__t2__l_quantity<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  supplier ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier2 ON partsupp2.ps_suppkey = supplier2.s_suppkey<br>&emsp;RIGHT JOIN nation nation2 ON supplier2.s_nationkey = nation2.n_nationkey ) t2 ON  t1.s_suppkey = t2.s_suppkey <br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem3<br>&emsp;INNER JOIN partsupp partsupp3 ON lineitem3.l_suppkey = partsupp3.ps_suppkey<br>&emsp; AND lineitem3.l_partkey = partsupp3.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier3 ON partsupp3.ps_suppkey = supplier3.s_suppkey<br>&emsp;INNER JOIN nation nation3 ON supplier3.s_nationkey = nation3.n_nationkey ) t3 ON  t1.s_suppkey = t3.s_suppkey  <br>WHERE<br>&emsp; t2.s_acctbal >=  586.16 <br>&emsp; OR t3.s_nationkey <=  13 <br>&emsp; OR t2.ps_comment >=  'al requests are deposits. furiously ironic asymptotes sleep ruthlessly about the regular<br>&emsp; ,idle ' <br>&emsp; OR t2.l_linestatus <=  'F' <br>&emsp; OR t3.s_comment >  'ts. furiously ironic pinto beans are permanently after the bold ideas. regular<br>&emsp; ,express f' <br>&emsp; OR t2.s_address >  'Saygah3gYWMp72i PY' <br>GROUP BY<br>&emsp; t2.n_comment <br>&emsp; ,t2.n_nationkey <br>&emsp; ,t2.s_nationkey <br>&emsp; ,t2.n_regionkey <br>&emsp; ,t3.n_name  <br>FETCH NEXt 605 ROWS ONLY

