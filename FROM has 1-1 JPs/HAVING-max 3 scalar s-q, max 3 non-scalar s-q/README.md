
#### Parameters defininig the current scenario are:
    * FROM has 1-1 JPs
    * groups may appear
    * HAVING-max 3 scalar s-q, max 3 non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT lineitem.l_suppkey AS lineitem__l_suppkey<br>&emsp; ,TO_CHAR(lineitem.l_commitdate, 'D') AS TO_CHAR__lineitem__l_commitdate____D__<br>&emsp; ,COUNT(FLOOR(lineitem.l_discount)) AS COUNT__FLOOR__lineitem__l_discount<br>FROM<br>&emsp; lineitem <br>WHERE<br>&emsp; lineitem.l_suppkey =  4 <br>&emsp; AND lineitem.l_shipmode >  'AIR       ' <br>&emsp; OR lineitem.l_linenumber <=  1 <br>GROUP BY<br>&emsp; lineitem.l_suppkey <br>&emsp; ,TO_CHAR(lineitem.l_commitdate, 'D')  <br>HAVING<br>&emsp;  COUNT(FLOOR(lineitem.l_discount)) <= ANY  <br>(SELECT  COUNT(FLOOR(lineitem.l_discount)) AS COUNT__FLOOR__lineitem__l_discount <br>FROM<br>&emsp;  lineitem  <br>WHERE<br>&emsp; lineitem.l_suppkey =  4 <br>&emsp; AND lineitem.l_shipmode >  'AIR       ' <br>&emsp; OR lineitem.l_linenumber <=  1 <br>&emsp; AND lineitem.l_shipinstruct >  'NONE                     ' <br>&emsp; AND lineitem.l_comment BETWEEN  'o are carefully after the slyly final'<br>&emsp; AND 'osits. boldly regular packages slee' <br>&emsp; AND lineitem.l_orderkey <=  17829  <br>GROUP BY<br>&emsp; lineitem.l_suppkey <br>&emsp; ,TO_CHAR(lineitem.l_commitdate, 'D')  )    or COUNT(FLOOR(lineitem.l_discount)) <>  <br>(SELECT  COUNT(FLOOR(lineitem.l_discount)) AS COUNT__FLOOR__lineitem__l_discount <br>FROM<br>&emsp;  lineitem  <br>WHERE<br>&emsp; lineitem.l_suppkey =  4 <br>&emsp; AND lineitem.l_shipmode >  'AIR       ' <br>&emsp; OR lineitem.l_linenumber <=  1 <br>&emsp; AND EXTRACT (MONTH FROM lineitem.l_shipdate)  >=  10  )    or COUNT(FLOOR(lineitem.l_discount)) not in ( <br>(SELECT  COUNT(FLOOR(lineitem.l_discount)) AS COUNT__FLOOR__lineitem__l_discount <br>FROM<br>&emsp;  lineitem  <br>WHERE<br>&emsp; lineitem.l_suppkey =  4 <br>&emsp; AND lineitem.l_shipmode >  'AIR       ' <br>&emsp; OR lineitem.l_linenumber <=  1 <br>&emsp; AND lineitem.l_linestatus <=  'O' <br>&emsp; AND lineitem.l_returnflag BETWEEN  'A'<br>&emsp; AND 'R'  )  )  or COUNT(FLOOR(lineitem.l_discount)) >=  <br>(SELECT  COUNT(FLOOR(lineitem.l_discount)) AS COUNT__FLOOR__lineitem__l_discount <br>FROM<br>&emsp;  lineitem  <br>WHERE<br>&emsp; lineitem.l_suppkey =  4 <br>&emsp; AND lineitem.l_shipmode >  'AIR       ' <br>&emsp; OR lineitem.l_linenumber <=  1 <br>&emsp; AND lineitem.l_orderkey >=  30660  )    or COUNT(FLOOR(lineitem.l_discount)) >=  1   or COUNT(FLOOR(lineitem.l_discount)) >  1   and COUNT(FLOOR(lineitem.l_discount)) >=  1  <br>ORDER BY<br>&emsp; COUNT(FLOOR(lineitem.l_discount)) DESC <br>FETCH NEXt 336 ROWS ONLY


<br>#### ... and a "lenghtier" one:
<br>


 SELECT nation.n_name AS nation__n_name<br>&emsp; ,customer.c_nationkey AS customer__c_nationkey<br>&emsp; ,customer.c_name AS customer__c_name<br>&emsp; ,COUNT(ABS(customer.c_acctbal)) AS COUNT__ABS__customer__c_acctbal<br>&emsp; ,COUNT(customer.c_phone) AS COUNT__customer__c_phone<br>FROM<br>&emsp; customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>GROUP BY<br>&emsp; nation.n_name <br>&emsp; ,customer.c_nationkey <br>&emsp; ,customer.c_name  <br>HAVING<br>&emsp;  COUNT(customer.c_phone) not in ( <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_phone BETWEEN  '17-576-345-5940'<br>&emsp; AND '26-314-406-7725'  ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_nationkey =  9  ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_mktsegment NOT BETWEEN  'AUTOMOBILE'<br>&emsp; AND 'FURNITURE '  ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_phone <>  '30-326-598-2437' <br>&emsp; AND customer.c_nationkey =  16 <br>&emsp; AND customer.c_acctbal >  -425.09  ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND nation.n_comment <  ' haggle. carefully final deposits detect slyly agai' <br>&emsp; AND customer.c_name IN  ( 'Customer#000000163', 'Customer#000000165', 'Customer#000000169', 'Customer#000001005', 'Customer#000001018', 'Customer#000001052', 'Customer#000001072', 'Customer#000001235', 'Customer#000001280')   ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_comment NOT IN  ( 'eodolites sleep according to the theodolites. slyly pending dolphins among the pending<br>&emsp; ,express platel', 'kly express theodolites sleep blithely across the doggedly regular packages. final<br>&emsp; ,unusual instruc', 'l requests are against the slyly ironic pinto beans. blithely unusual packages wake alongsid', 'regular dolphins. furiously careful ideas eat beyond the bravely regular packages. slyly unusual deposi', 'unts. blithely regular dependencies kindle pending deposits. quietly express deposits wake above the Tiresias-- ex')  <br>&emsp; AND nation.n_regionkey IN  ( 0, 1, 1, 1, 3, 4, 4, 4)  <br>&emsp; AND customer.c_custkey NOT IN  ( 619, 1022)   ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND nation.n_regionkey IN  ( 2)  <br>&emsp; AND nation.n_comment IN  ( 'c dependencies. furiously express notornis sleep slyly regular accounts. ideas sleep. depos', 'eans boost carefully special requests. accounts are. carefull', 'eas hang ironic<br>&emsp; ,silent packages. slyly regular packages are furiously over the tithes. fluffily bold', 'ic deposits are blithely about the carefully regular pa', 'ts. silent requests haggle. closely express packages sleep across the blithely', 'ven packages wake quickly. regu', 'y final packages. slow foxes cajole quickly. quickly silent platelets breach ironic accounts. unusual pinto be')   ) ,  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_name NOT IN  ( 'Customer#000000616', 'Customer#000000830', 'Customer#000001013', 'Customer#000001022', 'Customer#000001040', 'Customer#000001235', 'Customer#000001436', 'Customer#000001497')  <br>&emsp; AND nation.n_name NOT LIKE  '%     '  )  )  or COUNT(customer.c_phone) not between  2<br>&emsp; AND 6   or COUNT(customer.c_phone) <=  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND ROUND(customer.c_acctbal, 0)  <>  -849 <br>&emsp; AND customer.c_mktsegment NOT IN  ( 'AUTOMOBILE', 'AUTOMOBILE', 'FURNITURE ', 'FURNITURE ', 'HOUSEHOLD ', 'MACHINERY ', 'MACHINERY ', 'MACHINERY ')   )    and COUNT(customer.c_phone) >  <br>(SELECT  COUNT(customer.c_phone) AS COUNT__customer__c_phone <br>FROM<br>&emsp;  customer<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey  <br>WHERE<br>&emsp; customer.c_address =  'tbyect2HMX47TzsKy5 ho5' <br>&emsp; AND customer.c_mktsegment LIKE  '%OMOB%'  )   <br>ORDER BY<br>&emsp; nation.n_name ASC <br>FETCH NEXt 558 ROWS ONLY

