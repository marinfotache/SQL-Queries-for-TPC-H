
#### Parameters defininig the current scenario are:
    * FROM has 1-3 JPs
    * the join paths are joined by any attribute(s) of the linking table
    * groups may appear
    * HAVING-max 3 scalar s-q, no non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT nation.n_regionkey AS nation__n_regionkey<br>&emsp; ,customer.c_comment AS customer__c_comment<br>&emsp; ,COUNT(orders.o_custkey) AS COUNT__orders__o_custkey<br>FROM<br>&emsp; orders<br>&emsp;INNER JOIN customer ON orders.o_custkey = customer.c_custkey<br>&emsp;INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey <br>WHERE<br>&emsp; orders.o_shippriority <=  0 <br>GROUP BY<br>&emsp; nation.n_regionkey <br>&emsp; ,customer.c_comment  <br>ORDER BY<br>&emsp; nation.n_regionkey ASC <br>FETCH NEXt 491 ROWS ONLY


<br><br>#### ... and a "lengthier" one:
<br>


 SELECT t1.r_comment AS t1__r_comment<br>&emsp; ,UPPER(t1.r_name) AS UPPER__t1__r_name<br>&emsp; ,t2.n_comment AS t2__n_comment<br>&emsp; ,MAX(t1.s_acctbal) AS MAX__t1__s_acctbal<br>&emsp; ,COUNT(DISTINCT t1.r_regionkey) AS COUNT__DISTINCT__t1__r_regionkey<br>&emsp; ,COUNT(DISTINCT LOWER(t1.ps_comment)) AS COUNT__DISTINCT__LOWER__t1__ps_comment<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  nation ) t2 ON t1.n_comment = t2.n_comment<br>&emsp; AND t1.n_nationkey = t2.n_nationkey  <br>GROUP BY<br>&emsp; t1.r_comment ,  UPPER(t1.r_name) <br>&emsp; ,t2.n_comment  <br>HAVING<br>&emsp;  COUNT(DISTINCT t1.r_regionkey) not in ( 1, 2, 4, 5, 5 )  and COUNT(DISTINCT LOWER(t1.ps_comment)) in ( <br>(SELECT  COUNT(DISTINCT LOWER(t1.ps_comment)) AS COUNT__DISTINCT__LOWER__t1__ps_comment <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  nation ) t2 ON t1.n_comment = t2.n_comment<br>&emsp; AND t1.n_nationkey = t2.n_nationkey   <br>WHERE<br>&emsp; t1.n_name <=  'SAUDI ARABIA             ' <br>&emsp; AND t1.n_nationkey >=  9 <br>&emsp; AND t1.n_regionkey NOT IN  ( 0, 1, 2, 3, 4)   ) ,  <br>(SELECT  COUNT(DISTINCT LOWER(t1.ps_comment)) AS COUNT__DISTINCT__LOWER__t1__ps_comment <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  nation ) t2 ON t1.n_comment = t2.n_comment<br>&emsp; AND t1.n_nationkey = t2.n_nationkey   <br>WHERE<br>&emsp; t2.n_nationkey >=  17 <br>&emsp; AND ABS(t1.ps_availqty)  NOT BETWEEN  1097<br>&emsp; AND 8648  ) ,  <br>(SELECT  COUNT(DISTINCT LOWER(t1.ps_comment)) AS COUNT__DISTINCT__LOWER__t1__ps_comment <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  nation ) t2 ON t1.n_comment = t2.n_comment<br>&emsp; AND t1.n_nationkey = t2.n_nationkey   <br>WHERE<br>&emsp; t1.s_address <  '658tEqXLPvRd6xpFdqC2' <br>&emsp; AND t1.s_suppkey >=  63 <br>&emsp; AND SQRT(t1.s_nationkey)  IN  ( 3.16227766016838, 3.46410161513775, 4.24264068711928)   )  )  or MAX(t1.s_acctbal) =  <br>(SELECT  MAX(t1.s_acctbal) AS MAX__t1__s_acctbal <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey<br>&emsp;INNER JOIN nation nation1 ON supplier1.s_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;INNER JOIN<br>(SELECT *<br>FROM<br>&emsp;  nation ) t2 ON t1.n_comment = t2.n_comment<br>&emsp; AND t1.n_nationkey = t2.n_nationkey   <br>WHERE<br>&emsp; t1.ps_partkey IN  ( 285, 750, 881, 889, 1015, 1018, 1352, 1353, 1492, 1829)  <br>&emsp; AND t1.n_name >  'ROMANIA                  ' <br>&emsp; AND t1.s_comment >  'each slyly above the careful'  )   <br>ORDER BY<br>&emsp; COUNT(DISTINCT t1.r_regionkey) DESC <br>OFFSET 680 ROWS <br>FETCH NEXt 707 ROWS ONLY

