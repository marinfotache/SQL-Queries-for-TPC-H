
### Parameters defining the current scenario are:
    * FROM has 1-3 JPs-aalt
    * the join paths are joined by any attribute(s) of the linking table
    * groups may appear
    * HAVING-no scalar subqueries, no non-scalar subqueries

### Here is a typical query of this scenario:<br>



 SELECT t1.p_mfgr AS t1__p_mfgr<br>&emsp; ,t2.p_size AS t2__p_size<br>&emsp; ,t2.p_partkey AS t2__p_partkey<br>&emsp; ,t2.p_container AS t2__p_container<br>&emsp; ,COUNT(SQRT(t1.ps_supplycost)) AS COUNT__SQRT__t1__ps_supplycost<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN part part1 ON partsupp1.ps_partkey = part1.p_partkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp2<br>&emsp;INNER JOIN part part2 ON partsupp2.ps_partkey = part2.p_partkey ) t2 ON t1.p_name = t2.p_name<br>&emsp; AND t1.p_container = t2.p_container <br>&emsp;RIGHT JOIN<br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp3<br>&emsp;INNER JOIN supplier supplier3 ON partsupp3.ps_suppkey = supplier3.s_suppkey ) t3 ON  t1.ps_comment = t3.ps_comment  <br>WHERE<br>&emsp; t1.ps_partkey BETWEEN  23493878<br>&emsp; AND 23494337 <br>&emsp; AND t3.s_name >=  'Supplier#003737046' <br>&emsp; OR t2.ps_comment >=  'al requests use blithely furiously final deposits. blithely pending ideas haggle slyly across the carefully special dependencies? bold de' <br>GROUP BY<br>&emsp; t1.p_mfgr <br>&emsp; ,t2.p_size <br>&emsp; ,t2.p_partkey <br>&emsp; ,t2.p_container  <br>HAVING<br>&emsp;  COUNT(SQRT(t1.ps_supplycost)) =  4   or COUNT(SQRT(t1.ps_supplycost)) not in ( 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ) <br>ORDER BY<br>&emsp; t1.p_mfgr DESC<br>&emsp; ,t2.p_partkey DESC <br>FETCH NEXt 910 ROWS ONLY


<br><br>

### ... and a "lengthier" one:
<br>


 SELECT LTRIM(t3.l_comment) AS LTRIM__t3__l_comment<br>&emsp; ,EXTRACT (YEAR FROM t3.l_shipdate) AS EXTRACT____YEAR__FROM__t3__l_shipdate<br>&emsp; ,TO_CHAR(t3.l_shipdate, 'D') AS TO_CHAR__t3__l_shipdate____D__<br>&emsp; ,LOG(2<br>&emsp; ,t2.ps_supplycost) AS LOG__2__t2__ps_supplycost<br>&emsp; ,t3.l_shipinstruct AS t3__l_shipinstruct<br>&emsp; ,EXTRACT (MONTH FROM t2.l_shipdate) AS EXTRACT____MONTH__FROM__t2__l_shipdate<br>&emsp; ,EXTRACT (DAY FROM t2.l_shipdate) AS EXTRACT____DAY__FROM__t2__l_shipdate<br>&emsp; ,t1.o_clerk AS t1__o_clerk<br>&emsp; ,t2.n_nationkey AS t2__n_nationkey<br>&emsp; ,LOWER(t1.n_name) AS LOWER__t1__n_name<br>&emsp; ,t3.l_extendedprice AS t3__l_extendedprice<br>&emsp; ,t1.c_name AS t1__c_name<br>&emsp; ,t1.n_nationkey AS t1__n_nationkey<br>&emsp; ,EXTRACT (MONTH FROM t2.l_receiptdate) AS EXTRACT____MONTH__FROM__t2__l_receiptdate<br>&emsp; ,TO_CHAR(t2.l_receiptdate, 'D') AS TO_CHAR__t2__l_receiptdate____D__<br>&emsp; ,LTRIM(t1.l_shipinstruct) AS LTRIM__t1__l_shipinstruct<br>&emsp; ,t1.l_partkey AS t1__l_partkey<br>&emsp; ,t1.n_regionkey AS t1__n_regionkey<br>&emsp; ,SUBSTR(t1.o_comment, 5, 131) AS SUBSTR__t1__o_comment__5__131<br>&emsp; ,t1.l_commitdate AS t1__l_commitdate<br>&emsp; ,t2.s_acctbal AS t2__s_acctbal<br>&emsp; ,t1.c_mktsegment AS t1__c_mktsegment<br>&emsp; ,t1.o_orderstatus AS t1__o_orderstatus<br>&emsp; ,LOG(2<br>&emsp; ,t3.s_suppkey) AS LOG__2__t3__s_suppkey<br>&emsp; ,LTRIM(t3.s_address) AS LTRIM__t3__s_address<br>&emsp; ,t2.s_suppkey AS t2__s_suppkey<br>&emsp; ,LOWER(t1.l_linestatus) AS LOWER__t1__l_linestatus<br>&emsp; ,LTRIM(t2.r_comment) AS LTRIM__t2__r_comment<br>&emsp; ,t2.s_nationkey AS t2__s_nationkey<br>&emsp; ,t1.o_shippriority AS t1__o_shippriority<br>&emsp; ,LTRIM(t3.s_name) AS LTRIM__t3__s_name<br>&emsp; ,RTRIM(t3.r_comment) AS RTRIM__t3__r_comment<br>&emsp; ,t2.l_returnflag AS t2__l_returnflag<br>&emsp; ,EXTRACT (YEAR FROM t1.l_shipdate) AS EXTRACT____YEAR__FROM__t1__l_shipdate<br>&emsp; ,EXTRACT (MONTH FROM t3.l_receiptdate) AS EXTRACT____MONTH__FROM__t3__l_receiptdate<br>&emsp; ,TO_CHAR(t3.l_receiptdate, 'D') AS TO_CHAR__t3__l_receiptdate____D__<br>&emsp; ,t2.s_comment AS t2__s_comment<br>&emsp; ,LOWER(t3.l_linestatus) AS LOWER__t3__l_linestatus<br>&emsp; ,SUBSTR(t3.l_shipmode, 2, 3) AS SUBSTR__t3__l_shipmode__2__3<br>&emsp; ,UPPER(t2.s_phone) AS UPPER__t2__s_phone<br>&emsp; ,LOWER(t2.r_name) AS LOWER__t2__r_name<br>&emsp; ,t3.r_regionkey AS t3__r_regionkey<br>&emsp; ,ROUND(t2.l_tax, 1) AS ROUND__t2__l_tax__1<br>&emsp; ,LOWER(t2.n_comment) AS LOWER__t2__n_comment<br>&emsp; ,t1.o_custkey AS t1__o_custkey<br>&emsp; ,t1.l_tax AS t1__l_tax<br>&emsp; ,t1.o_orderdate AS t1__o_orderdate<br>&emsp; ,t3.s_comment AS t3__s_comment<br>&emsp; ,t2.l_discount AS t2__l_discount<br>&emsp; ,TRUNC(t1.l_extendedprice, 2) AS TRUNC__t1__l_extendedprice__2<br>&emsp; ,t2.s_address AS t2__s_address<br>&emsp; ,EXTRACT (YEAR FROM t3.l_commitdate) AS EXTRACT____YEAR__FROM__t3__l_commitdate<br>&emsp; ,TO_CHAR(t3.l_commitdate, 'D') AS TO_CHAR__t3__l_commitdate____D__<br>&emsp; ,t3.l_linenumber AS t3__l_linenumber<br>&emsp; ,t1.l_orderkey AS t1__l_orderkey<br>&emsp; ,t3.n_nationkey AS t3__n_nationkey<br>&emsp; ,t3.l_tax AS t3__l_tax<br>&emsp; ,t2.l_linestatus AS t2__l_linestatus<br>&emsp; ,t3.l_returnflag AS t3__l_returnflag<br>&emsp; ,SUBSTR(t1.c_address, 5, 36) AS SUBSTR__t1__c_address__5__36<br>&emsp; ,t1.n_comment AS t1__n_comment<br>&emsp; ,SQRT(t2.l_quantity) AS SQRT__t2__l_quantity<br>&emsp; ,t3.s_nationkey AS t3__s_nationkey<br>&emsp; ,t2.l_partkey AS t2__l_partkey<br>&emsp; ,t1.l_returnflag AS t1__l_returnflag<br>&emsp; ,t1.c_nationkey AS t1__c_nationkey<br>&emsp; ,t3.l_discount AS t3__l_discount<br>&emsp; ,t3.ps_partkey AS t3__ps_partkey<br>&emsp; ,SQRT(t1.o_orderkey) AS SQRT__t1__o_orderkey<br>&emsp; ,FLOOR(t1.o_totalprice) AS FLOOR__t1__o_totalprice<br>&emsp; ,t3.n_name AS t3__n_name<br>&emsp; ,t1.l_suppkey AS t1__l_suppkey<br>&emsp; ,SUBSTR(t1.c_phone, 1, 2) AS SUBSTR__t1__c_phone__1__2<br>&emsp; ,t1.l_linenumber AS t1__l_linenumber<br>&emsp; ,t2.ps_suppkey AS t2__ps_suppkey<br>&emsp; ,t2.r_regionkey AS t2__r_regionkey<br>&emsp; ,t2.l_linenumber AS t2__l_linenumber<br>&emsp; ,SQRT(t2.ps_availqty) AS SQRT__t2__ps_availqty<br>&emsp; ,t1.l_comment AS t1__l_comment<br>&emsp; ,UPPER(t3.r_name) AS UPPER__t3__r_name<br>&emsp; ,t1.l_quantity AS t1__l_quantity<br>&emsp; ,RTRIM(t2.l_shipmode) AS RTRIM__t2__l_shipmode<br>&emsp; ,t2.l_extendedprice AS t2__l_extendedprice<br>&emsp; ,FLOOR(t3.l_quantity) AS FLOOR__t3__l_quantity<br>&emsp; ,t3.ps_suppkey AS t3__ps_suppkey<br>&emsp; ,t1.o_orderpriority AS t1__o_orderpriority<br>&emsp; ,EXTRACT (DAY FROM t2.l_commitdate) AS EXTRACT____DAY__FROM__t2__l_commitdate<br>&emsp; ,RTRIM(t2.l_comment) AS RTRIM__t2__l_comment<br>&emsp; ,t3.l_partkey AS t3__l_partkey<br>&emsp; ,TO_CHAR(t1.l_receiptdate, 'D') AS TO_CHAR__t1__l_receiptdate____D__<br>&emsp; ,RTRIM(t1.l_shipmode) AS RTRIM__t1__l_shipmode<br>&emsp; ,t3.n_regionkey AS t3__n_regionkey<br>&emsp; ,t1.c_acctbal AS t1__c_acctbal<br>&emsp; ,t2.n_regionkey AS t2__n_regionkey<br>&emsp; ,SQRT(t3.ps_availqty) AS SQRT__t3__ps_availqty<br>&emsp; ,t2.l_suppkey AS t2__l_suppkey<br>&emsp; ,t3.ps_supplycost AS t3__ps_supplycost<br>&emsp; ,LOG(2<br>&emsp; ,t1.c_custkey) AS LOG__2__t1__c_custkey<br>&emsp; ,LTRIM(t2.s_name) AS LTRIM__t2__s_name<br>&emsp; ,UPPER(t2.n_name) AS UPPER__t2__n_name<br>&emsp; ,t2.l_orderkey AS t2__l_orderkey<br>&emsp; ,t2.l_shipinstruct AS t2__l_shipinstruct<br>&emsp; ,RTRIM(t3.s_phone) AS RTRIM__t3__s_phone<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  lineitem lineitem1<br>&emsp;INNER JOIN orders orders1 ON lineitem1.l_orderkey = orders1.o_orderkey<br>&emsp;INNER JOIN customer customer1 ON orders1.o_custkey = customer1.c_custkey<br>&emsp;INNER JOIN nation nation1 ON customer1.c_nationkey = nation1.n_nationkey ) t1 FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem2<br>&emsp;INNER JOIN partsupp partsupp2 ON lineitem2.l_suppkey = partsupp2.ps_suppkey<br>&emsp; AND lineitem2.l_partkey = partsupp2.ps_partkey<br>&emsp;INNER JOIN supplier supplier2 ON partsupp2.ps_suppkey = supplier2.s_suppkey<br>&emsp;INNER JOIN nation nation2 ON supplier2.s_nationkey = nation2.n_nationkey<br>&emsp;RIGHT JOIN region region2 ON nation2.n_regionkey = region2.r_regionkey ) t2 ON t1.n_nationkey = t2.n_nationkey<br>&emsp; AND t1.n_regionkey = t2.n_regionkey  FULL JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem3<br>&emsp;INNER JOIN partsupp partsupp3 ON lineitem3.l_suppkey = partsupp3.ps_suppkey<br>&emsp; AND lineitem3.l_partkey = partsupp3.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier3 ON partsupp3.ps_suppkey = supplier3.s_suppkey<br>&emsp;RIGHT JOIN nation nation3 ON supplier3.s_nationkey = nation3.n_nationkey<br>&emsp;RIGHT JOIN region region3 ON nation3.n_regionkey = region3.r_regionkey ) t3 ON t1.l_suppkey = t3.l_suppkey<br>&emsp; AND l_linestatus<br>&emsp; AND t1.l_shipmode = t3.l_shipmode  <br>WHERE<br>&emsp; t1.c_comment IN  ( ' furiously regular accounts. slyly regular ', ' pinto beans! furiously regular courts ea', ' requests. final ideas cajole quickly at the special<br>&emsp; ,ironic acco', ' unusual deposits. furiously even packages against the furiously even ac', 'al instructions haggle against the slyly bold w', 'e furiously pending requests. slyly bold requests wake deposits. furiously express', 'nto beans. dinos sleep fluffily carefully regular sentiments. final<br>&emsp; ,special packages wake blithely. ironic ', 'special packages against the slyly final pinto beans wake slyly furiously final ', 'yly fluffy foxes boost final ideas. b')  <br>&emsp; AND ABS(t3.ps_availqty)  NOT IN  ( 31, 2367, 4279, 6429, 6840, 6974, 7039, 7469, 9407)  <br>&emsp; AND t1.o_orderpriority BETWEEN  '1-URGENT       '<br>&emsp; AND '2-HIGH         ' <br>&emsp; OR t1.l_discount <>  0.1 <br>&emsp; OR t3.l_shipinstruct NOT BETWEEN  'DELIVER IN PERSON        '<br>&emsp; AND 'TAKE BACK RETURN         ' <br>ORDER BY<br>&emsp; EXTRACT (YEAR FROM t3.l_shipdate) DESC<br>&emsp; ,FLOOR(t1.o_totalprice) ASC<br>&emsp; ,LOWER(t1.l_linestatus) ASC<br>&emsp; ,t2.l_returnflag DESC<br>&emsp; ,t1.o_custkey DESC <br>OFFSET 944 ROWS <br>FETCH NEXt 227 ROWS ONLY

