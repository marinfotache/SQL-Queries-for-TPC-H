
#### Parameters defininig the current scenario are:
    * FROM has 1-3 JPs
    * the join paths are joined by any attribute(s) of the linking table
    * groups may appear
    * HAVING-max 3 scalar s-q, max 3 non-scalar s-q

#### Here is an "average" query of this scenario:<br>



 SELECT distinct t3.l_suppkey AS t3__l_suppkey<br>&emsp; ,t3.s_phone AS t3__s_phone<br>&emsp; ,t3.s_nationkey AS t3__s_nationkey<br>&emsp; ,t2.s_nationkey AS t2__s_nationkey<br>&emsp; ,t1.s_acctbal AS t1__s_acctbal<br>&emsp; ,RTRIM(t3.l_linestatus) AS RTRIM__t3__l_linestatus<br>&emsp; ,t3.l_comment AS t3__l_comment<br>&emsp; ,RTRIM(t2.s_comment) AS RTRIM__t2__s_comment<br>&emsp; ,EXTRACT (DAY FROM t3.l_commitdate) AS EXTRACT____DAY__FROM__t3__l_commitdate<br>&emsp; ,SQRT(t3.l_partkey) AS SQRT__t3__l_partkey<br>&emsp; ,ABS(t2.s_acctbal) AS ABS__t2__s_acctbal<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  partsupp partsupp1<br>&emsp;RIGHT JOIN supplier supplier1 ON partsupp1.ps_suppkey = supplier1.s_suppkey ) t1<br>&emsp;LEFT JOIN<br>(SELECT *<br>FROM<br>&emsp;  partsupp partsupp2<br>&emsp;INNER JOIN supplier supplier2 ON partsupp2.ps_suppkey = supplier2.s_suppkey ) t2 ON t1.s_nationkey = t2.s_nationkey<br>&emsp; AND t1.s_name = t2.s_name <br>&emsp;RIGHT JOIN<br>(SELECT *<br>FROM<br>&emsp;  lineitem lineitem3<br>&emsp;INNER JOIN partsupp partsupp3 ON lineitem3.l_suppkey = partsupp3.ps_suppkey<br>&emsp; AND lineitem3.l_partkey = partsupp3.ps_partkey<br>&emsp;RIGHT JOIN supplier supplier3 ON partsupp3.ps_suppkey = supplier3.s_suppkey ) t3 ON  t1.ps_partkey = t3.ps_partkey  <br>WHERE<br>&emsp; t2.s_address >=  '9y3OZ2CV hGrsrQxzB7V3zTtygHVHlG3SD6yrz' <br>&emsp; OR ROUND(t3.ps_availqty, 0)  <  3020 <br>ORDER BY<br>&emsp; RTRIM(t2.s_comment) ASC<br>&emsp; ,t2.s_nationkey DESC <br>FETCH NEXt 39 ROWS ONLY


<br><br>#### ... and a "lengthier" one:
<br>


 SELECT SUBSTR(t2.r_name, 4, 90) AS SUBSTR__t2__r_name__4__90<br>&emsp; ,t1.r_regionkey AS t1__r_regionkey<br>&emsp; ,COUNT(DISTINCT t2.c_comment) AS COUNT__DISTINCT__t2__c_comment<br>FROM<br>&emsp; (SELECT *<br>FROM<br>&emsp;  customer customer1<br>&emsp;INNER JOIN nation nation1 ON customer1.c_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;RIGHT JOIN<br>(SELECT *<br>FROM<br>&emsp;  customer customer2<br>&emsp;RIGHT JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey<br>&emsp;RIGHT JOIN region region2 ON nation2.n_regionkey = region2.r_regionkey ) t2 ON t1.r_comment = t2.r_comment<br>&emsp; AND r_regionkey<br>&emsp; AND t1.r_name = t2.r_name  <br>WHERE<br>&emsp; t2.r_comment <=  'ly final courts cajole furiously final excuse' <br>&emsp; AND t1.c_address >  '5Zsp rqM6oCmgqqFe' <br>&emsp; AND t1.c_nationkey IN  ( 11)  <br>&emsp; OR t1.n_name >  'MOROCCO                  ' <br>&emsp; AND t1.n_comment <=  'ously. final<br>&emsp; ,express gifts cajole a' <br>GROUP BY<br>&emsp;  SUBSTR(t2.r_name, 4, 90) <br>&emsp; ,t1.r_regionkey  <br>HAVING<br>&emsp;  COUNT(DISTINCT t2.c_comment) not between  8<br>&emsp; AND 9   and COUNT(DISTINCT t2.c_comment) <>  <br>(SELECT  COUNT(DISTINCT t2.c_comment) AS COUNT__DISTINCT__t2__c_comment <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  customer customer1<br>&emsp;INNER JOIN nation nation1 ON customer1.c_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;RIGHT JOIN<br>(SELECT *<br>FROM<br>&emsp;  customer customer2<br>&emsp;RIGHT JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey<br>&emsp;RIGHT JOIN region region2 ON nation2.n_regionkey = region2.r_regionkey ) t2 ON t1.r_comment = t2.r_comment<br>&emsp; AND r_regionkey<br>&emsp; AND t1.r_name = t2.r_name   <br>WHERE<br>&emsp; t2.r_comment <=  'ly final courts cajole furiously final excuse' <br>&emsp; AND t1.c_address >  '5Zsp rqM6oCmgqqFe' <br>&emsp; AND t1.c_nationkey IN  ( 11)  <br>&emsp; OR t1.n_name >  'MOROCCO                  ' <br>&emsp; AND t1.n_comment <=  'ously. final<br>&emsp; ,express gifts cajole a' <br>&emsp; AND t1.r_comment IN  ( 'ges. thinly even pinto beans ca', 'lar deposits. blithely final packages cajole. regular waters are final requests. regular accounts are according to ', 'ly final courts cajole furiously final excuse', 'uickly special accounts cajole carefully blithely close requests. carefully final asymptotes haggle furiousl')  <br>&emsp; AND t2.c_name <>  'Customer#000001046' <br>&emsp; AND t2.c_mktsegment BETWEEN  'BUILDING  '<br>&emsp; AND 'MACHINERY '  )    or COUNT(DISTINCT t2.c_comment) <>  7   or COUNT(DISTINCT t2.c_comment) in ( <br>(SELECT  COUNT(DISTINCT t2.c_comment) AS COUNT__DISTINCT__t2__c_comment <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  customer customer1<br>&emsp;INNER JOIN nation nation1 ON customer1.c_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;RIGHT JOIN<br>(SELECT *<br>FROM<br>&emsp;  customer customer2<br>&emsp;RIGHT JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey<br>&emsp;RIGHT JOIN region region2 ON nation2.n_regionkey = region2.r_regionkey ) t2 ON t1.r_comment = t2.r_comment<br>&emsp; AND r_regionkey<br>&emsp; AND t1.r_name = t2.r_name   <br>WHERE<br>&emsp; t2.r_comment <=  'ly final courts cajole furiously final excuse' <br>&emsp; AND t1.c_address >  '5Zsp rqM6oCmgqqFe' <br>&emsp; AND t1.c_nationkey IN  ( 11)  <br>&emsp; OR t1.n_name >  'MOROCCO                  ' <br>&emsp; AND t1.n_comment <=  'ously. final<br>&emsp; ,express gifts cajole a' <br>&emsp; AND t1.c_comment BETWEEN  'lar accounts sublate above the slyly final'<br>&emsp; AND 'y<br>&emsp; ,regular requests above the fluffily special deposits engage around the furiously' <br>&emsp; AND t2.c_mktsegment BETWEEN  'HOUSEHOLD '<br>&emsp; AND 'MACHINERY '  <br>GROUP BY<br>&emsp;  SUBSTR(t2.r_name, 4, 90) <br>&emsp; ,t1.r_regionkey  )  )  or COUNT(DISTINCT t2.c_comment) >= ALL  <br>(SELECT  COUNT(DISTINCT t2.c_comment) AS COUNT__DISTINCT__t2__c_comment <br>FROM<br>&emsp; <br>(SELECT *<br>FROM<br>&emsp;  customer customer1<br>&emsp;INNER JOIN nation nation1 ON customer1.c_nationkey = nation1.n_nationkey<br>&emsp;INNER JOIN region region1 ON nation1.n_regionkey = region1.r_regionkey ) t1<br>&emsp;RIGHT JOIN<br>(SELECT *<br>FROM<br>&emsp;  customer customer2<br>&emsp;RIGHT JOIN nation nation2 ON customer2.c_nationkey = nation2.n_nationkey<br>&emsp;RIGHT JOIN region region2 ON nation2.n_regionkey = region2.r_regionkey ) t2 ON t1.r_comment = t2.r_comment<br>&emsp; AND r_regionkey<br>&emsp; AND t1.r_name = t2.r_name   <br>WHERE<br>&emsp; t2.r_comment <=  'ly final courts cajole furiously final excuse' <br>&emsp; AND t1.c_address >  '5Zsp rqM6oCmgqqFe' <br>&emsp; AND t1.c_nationkey IN  ( 11)  <br>&emsp; OR t1.n_name >  'MOROCCO                  ' <br>&emsp; AND t1.n_comment <=  'ously. final<br>&emsp; ,express gifts cajole a' <br>&emsp; AND t2.c_phone LIKE  '13-533-%'  <br>GROUP BY<br>&emsp;  SUBSTR(t2.r_name, 4, 90) <br>&emsp; ,t1.r_regionkey  )   <br>ORDER BY<br>&emsp; SUBSTR(t2.r_name, 4, 90) DESC <br>OFFSET 44 ROWS <br>FETCH NEXt 287 ROWS ONLY

